pipeline {
    agent any

    stages {
        // stage('Build') {
        //     steps {
        //         echo 'Building the application ...'
        //     }
        // }
        // stage('Test') {
        //     steps {
        //         echo 'Testing the application'
        //     }
        // }
        // stage('Deploy') {
        //     steps {
        //         echo 'Deploying the application'
        //     }
        // }
        // stage('Jenkins Python code')
        // {
        //     steps {
        //         bat 'python ops.py'

        //     }
        // }
        stage('python test'){
            steps{
                // bat 'python -m pytest'
                bat 'python unit-test.py'
            }
        }
        stage ("Test Report Generation")

        {

            steps{

                // bat 'java -Xms1300m -Xmx1300m -classpath "myClassPath;anotherone;anotherOne" -Xdebug "-Djava.compiler=NONE" "-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5005"'

                // bat 'javac Palindrome.java'

                // bat 'java Palindrome'

                // bat 'javac PalindromeTest.java'

                // bat 'java PalindromeTest'

               

                bat 'python -m pytest --verbose --junit-xml reports/unit_tests.xml'

            }

            post{

                always{

                    junit allowEmptyResults: true, testResults: 'reports/unit_tests.xml'

                }

                success{

                    echo "========Calculator Test Cases executed successfully========"

                }

                failure{

                    echo "========Calculator Test Cases execution failed========"

                }

            }

        }
        
    }
    post{
        always{
            echo "Hi Gaurav, Email from pipeline"
        }
        success{

            echo "pipeline execution passed "

            mail to : "gauravdeshmukh7083@gmail.com",

            subject : "Pipeline Completed",

            body : "Pipeline Completetd "

        }

        failure{

            echo "pipeline execution failed"

            mail to : "gauravdeshmukh7083@gmail.com",

            subject : "Pipeline Failed",

            body : "Pipeline Failed"

        }
    }
}
